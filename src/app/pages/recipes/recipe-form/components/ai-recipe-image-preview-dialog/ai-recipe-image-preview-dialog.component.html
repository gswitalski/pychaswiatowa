<h2 mat-dialog-title>
    <mat-icon class="dialog-title-icon">auto_awesome</mat-icon>
    Podgląd zdjęcia (AI)
</h2>

<mat-dialog-content>
    @if (isLoading()) {
        <!-- Loading state -->
        <div class="loading-container">
            <mat-spinner diameter="64"></mat-spinner>
            <p class="loading-text">Generujemy zdjęcie dla „{{ data.recipeName }}"...</p>
            <p class="loading-hint">To może zająć do minuty</p>
        </div>
    } @else if (isError()) {
        <!-- Error state -->
        <div class="error-container">
            <mat-icon class="error-icon">error_outline</mat-icon>
            <p class="error-message">{{ errorMessage() }}</p>
            @if (errorReasons().length > 0) {
                <ul class="error-reasons">
                    @for (reason of errorReasons(); track reason) {
                        <li>{{ reason }}</li>
                    }
                </ul>
            }
        </div>
    } @else if (isSuccess()) {
        <!-- Success state -->
        <div class="success-container">
            <div class="image-preview">
                <img
                    [src]="imageDataUrl()"
                    alt="Wygenerowane zdjęcie przepisu"
                    class="generated-image"
                />
            </div>
            <p class="style-info">
                <mat-icon class="info-icon">info</mat-icon>
                Realistyczne zdjęcie w stylu rustykalnym
            </p>
        </div>
    }
</mat-dialog-content>

<mat-dialog-actions align="end">
    @if (isError()) {
        <!-- Error state: only close button -->
        <button
            mat-stroked-button
            type="button"
            (click)="onCancel()"
        >
            Zamknij
        </button>
    } @else {
        <!-- Loading/Success state: reject and apply buttons -->
        <button
            mat-stroked-button
            type="button"
            [disabled]="actionsDisabled()"
            (click)="onReject()"
        >
            Odrzuć
        </button>
        <button
            mat-flat-button
            color="primary"
            type="button"
            [disabled]="actionsDisabled()"
            (click)="onApply()"
        >
            @if (applying()) {
                <mat-spinner diameter="20"></mat-spinner>
            } @else {
                Zastosuj
            }
        </button>
    }
</mat-dialog-actions>

