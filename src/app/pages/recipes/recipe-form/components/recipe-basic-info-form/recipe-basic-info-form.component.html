<div class="basic-info-form">
    <mat-form-field appearance="outline" class="full-width">
        <mat-label>Nazwa przepisu</mat-label>
        <input
            matInput
            [formControl]="nameControl"
            placeholder="np. Sernik na zimno"
            maxlength="150"
        />
        @if (nameControl.hasError('required') && nameControl.touched) {
            <mat-error>Nazwa przepisu jest wymagana</mat-error>
        }
        @if (nameControl.hasError('maxlength')) {
            <mat-error>Nazwa może mieć maksymalnie 150 znaków</mat-error>
        }
        <mat-hint align="end">{{ nameControl.value.length }} / 150</mat-hint>
    </mat-form-field>

    <mat-form-field appearance="outline" class="full-width">
        <mat-label>Opis</mat-label>
        <textarea
            matInput
            [formControl]="descriptionControl"
            placeholder="Krótki opis przepisu..."
            rows="4"
        ></textarea>
        <mat-hint>Opcjonalny opis przepisu</mat-hint>
    </mat-form-field>

    <mat-form-field appearance="outline" class="full-width">
        <mat-label>Liczba porcji</mat-label>
        <input
            matInput
            type="number"
            [formControl]="servingsControl"
            placeholder="np. 4"
            min="1"
            max="99"
            step="1"
            inputmode="numeric"
        />
        @if (servingsControl.value !== null && servingsControl.value !== undefined) {
            <button
                mat-icon-button
                matSuffix
                type="button"
                (click)="clearServings()"
                aria-label="Wyczyść liczbę porcji"
            >
                <mat-icon>clear</mat-icon>
            </button>
        }
        @if (servingsControl.hasError('required') && servingsControl.touched) {
            <mat-error>Liczba porcji jest wymagana</mat-error>
        }
        @if (servingsControl.hasError('min') && !servingsControl.hasError('required')) {
            <mat-error>Minimalna wartość to 1</mat-error>
        }
        @if (servingsControl.hasError('max') && !servingsControl.hasError('required')) {
            <mat-error>Maksymalna wartość to 99</mat-error>
        }
        @if (servingsControl.hasError('notInteger') && !servingsControl.hasError('required') && !servingsControl.hasError('min') && !servingsControl.hasError('max')) {
            <mat-error>Podaj liczbę całkowitą</mat-error>
        }
        <mat-hint>Opcjonalne. Zakres 1–99.</mat-hint>
    </mat-form-field>

    <mat-form-field appearance="outline" class="full-width">
        <mat-label>Czas przygotowania (min)</mat-label>
        <input
            matInput
            type="number"
            [formControl]="prepTimeMinutesControl"
            placeholder="np. 30"
            min="0"
            max="999"
            step="1"
            inputmode="numeric"
        />
        @if (prepTimeMinutesControl.value !== null && prepTimeMinutesControl.value !== undefined) {
            <button
                mat-icon-button
                matSuffix
                type="button"
                (click)="clearPrepTime()"
                aria-label="Wyczyść czas przygotowania"
            >
                <mat-icon>clear</mat-icon>
            </button>
        }
        @if (prepTimeMinutesControl.hasError('min')) {
            <mat-error>Minimalna wartość to 0</mat-error>
        }
        @if (prepTimeMinutesControl.hasError('max')) {
            <mat-error>Maksymalna wartość to 999</mat-error>
        }
        @if (prepTimeMinutesControl.hasError('notInteger') && !prepTimeMinutesControl.hasError('min') && !prepTimeMinutesControl.hasError('max')) {
            <mat-error>Podaj liczbę całkowitą</mat-error>
        }
        <mat-hint>Opcjonalne. Zakres 0–999.</mat-hint>
    </mat-form-field>

    <mat-form-field appearance="outline" class="full-width">
        <mat-label>Czas całkowity (min)</mat-label>
        <input
            matInput
            type="number"
            [formControl]="totalTimeMinutesControl"
            placeholder="np. 90"
            min="0"
            max="999"
            step="1"
            inputmode="numeric"
        />
        @if (totalTimeMinutesControl.value !== null && totalTimeMinutesControl.value !== undefined) {
            <button
                mat-icon-button
                matSuffix
                type="button"
                (click)="clearTotalTime()"
                aria-label="Wyczyść czas całkowity"
            >
                <mat-icon>clear</mat-icon>
            </button>
        }
        @if (totalTimeMinutesControl.hasError('min')) {
            <mat-error>Minimalna wartość to 0</mat-error>
        }
        @if (totalTimeMinutesControl.hasError('max')) {
            <mat-error>Maksymalna wartość to 999</mat-error>
        }
        @if (totalTimeMinutesControl.hasError('notInteger') && !totalTimeMinutesControl.hasError('min') && !totalTimeMinutesControl.hasError('max')) {
            <mat-error>Podaj liczbę całkowitą</mat-error>
        }
        @if (totalTimeMinutesControl.hasError('totalLessThanPrep')) {
            <mat-error>Czas całkowity nie może być mniejszy niż czas przygotowania</mat-error>
        }
        <mat-hint>Opcjonalne. Zakres 0–999. Jeśli uzupełnisz oba pola, czas całkowity musi być ≥ przygotowania.</mat-hint>
    </mat-form-field>

    <mat-form-field appearance="outline" class="full-width">
        <mat-label>Typ diety</mat-label>
        <mat-select [formControl]="dietTypeControl" placeholder="Wybierz typ diety">
            @for (option of dietTypeOptions; track option) {
                <mat-option [value]="option">
                    {{ dietTypeLabels[option] }}
                </mat-option>
            }
        </mat-select>
        @if (dietTypeControl.value !== null) {
            <button
                mat-icon-button
                matSuffix
                type="button"
                (click)="clearDietType()"
                aria-label="Wyczyść typ diety"
            >
                <mat-icon>clear</mat-icon>
            </button>
        }
        <mat-hint>Opcjonalne. Klasyfikacja ze względu na dietę.</mat-hint>
    </mat-form-field>

    <mat-form-field appearance="outline" class="full-width">
        <mat-label>Kuchnia</mat-label>
        <input
            matInput
            type="text"
            [formControl]="cuisineInputControl"
            [matAutocomplete]="cuisineAuto"
            placeholder="Wpisz lub wybierz kuchnię"
        />
        <mat-autocomplete
            #cuisineAuto="matAutocomplete"
            (optionSelected)="onCuisineSelected($event.option.value)"
        >
            @for (option of filteredCuisineOptions(); track option) {
                <mat-option [value]="option">
                    {{ cuisineLabels[option] }}
                </mat-option>
            }
        </mat-autocomplete>
        @if (cuisineControl.value !== null) {
            <button
                mat-icon-button
                matSuffix
                type="button"
                (click)="clearCuisine()"
                aria-label="Wyczyść kuchnię"
            >
                <mat-icon>clear</mat-icon>
            </button>
        }
        <mat-hint>Opcjonalne. Wpisz nazwę lub rozwiń listę. Klasyfikacja ze względu na typ kuchni.</mat-hint>
    </mat-form-field>

    <mat-form-field appearance="outline" class="full-width">
        <mat-label>Stopień trudności</mat-label>
        <mat-select [formControl]="difficultyControl" placeholder="Wybierz stopień trudności">
            @for (option of difficultyOptions; track option) {
                <mat-option [value]="option">
                    {{ difficultyLabels[option] }}
                </mat-option>
            }
        </mat-select>
        @if (difficultyControl.value !== null) {
            <button
                mat-icon-button
                matSuffix
                type="button"
                (click)="clearDifficulty()"
                aria-label="Wyczyść stopień trudności"
            >
                <mat-icon>clear</mat-icon>
            </button>
        }
        <mat-hint>Opcjonalne. Klasyfikacja ze względu na poziom trudności.</mat-hint>
    </mat-form-field>

    <div class="termorobot-toggle">
        <mat-slide-toggle [formControl]="isTermorobotControl">
            Termorobot (Thermomix/Lidlomix)
        </mat-slide-toggle>
        <p class="toggle-hint">Zaznacz, jeśli przepis jest przeznaczony dla urządzeń typu Thermomix lub Lidlomix</p>
    </div>

    <div class="grill-toggle">
        <mat-slide-toggle [formControl]="isGrillControl">
            Grill
        </mat-slide-toggle>
        <p class="toggle-hint">Zaznacz, jeśli przepis jest przeznaczony na grilla/barbecue</p>
    </div>
</div>

