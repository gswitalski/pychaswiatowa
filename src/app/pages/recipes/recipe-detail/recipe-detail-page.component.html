<pych-page-header
    [title]="pageTitle()"
    [showBackButton]="true"
>
    @if (hasRecipe()) {
        <button
            mat-icon-button
            matTooltip="Dodaj do kolekcji"
            aria-label="Dodaj do kolekcji"
            (click)="onAddToCollection()"
        >
            <mat-icon>bookmark_add</mat-icon>
        </button>
        <button
            mat-icon-button
            matTooltip="Edytuj przepis"
            aria-label="Edytuj przepis"
            (click)="onEdit()"
        >
            <mat-icon>edit</mat-icon>
        </button>
        <button
            mat-icon-button
            matTooltip="Usuń przepis"
            aria-label="Usuń przepis"
            color="warn"
            (click)="onDelete()"
        >
            <mat-icon>delete</mat-icon>
        </button>
    }
</pych-page-header>

<div class="recipe-detail-page">
    @if (isLoading()) {
        <div class="loading-state">
            <mat-spinner diameter="48"></mat-spinner>
            <p>Ładowanie przepisu...</p>
        </div>
    } @else if (error()) {
        <mat-card class="error-card">
            <mat-card-content>
                <mat-icon class="error-icon">error_outline</mat-icon>
                @if (error()!.status === 404) {
                    <h2>Nie znaleziono przepisu</h2>
                    <p>Przepis, którego szukasz, nie istnieje lub został usunięty.</p>
                } @else {
                    <h2>Wystąpił błąd</h2>
                    <p>{{ error()!.message }}</p>
                }
                <button mat-raised-button (click)="onBackToList()">
                    <mat-icon>arrow_back</mat-icon>
                    Wróć do listy przepisów
                </button>
            </mat-card-content>
        </mat-card>
    } @else if (hasRecipe()) {
        <div class="recipe-content">
            <!-- Wiersz 1: Header - tytuł, opis (lewa) + zdjęcie (prawa) -->
            <div class="recipe-header-section">
                <div class="recipe-info">
                    <pych-recipe-header [recipe]="recipe()!" />
                </div>

                <pych-recipe-image
                    [imageUrl]="recipe()!.image_path"
                    [recipeName]="recipe()!.name ?? ''"
                />
            </div>

            <!-- Wiersz 2: Składniki (lewa) + kroki przygotowania (prawa) -->
            <div class="recipe-details">
                <pych-recipe-content-list
                    title="Składniki"
                    [content]="recipe()!.ingredients"
                />

                <pych-recipe-content-list
                    title="Kroki przygotowania"
                    [content]="recipe()!.steps"
                />
            </div>
        </div>
    }
</div>
