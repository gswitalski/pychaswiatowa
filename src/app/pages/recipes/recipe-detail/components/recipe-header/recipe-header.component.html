<header class="recipe-header">
    <h1 class="recipe-title">{{ recipe().name }}</h1>

    @if (servingsLabel()) {
        <p class="recipe-servings">{{ servingsLabel() }}</p>
    }

    @if (recipe().description) {
        <p class="recipe-description">{{ recipe().description }}</p>
    }

    @if (shouldShowPrepTime() || shouldShowTotalTime()) {
        <div class="recipe-times">
            @if (shouldShowPrepTime()) {
                <div class="time-item">
                    <mat-icon aria-label="Czas przygotowania">schedule</mat-icon>
                    <span>{{ recipe().prep_time_minutes | durationMinutes }}</span>
                </div>
            }
            @if (shouldShowTotalTime()) {
                <div class="time-item">
                    <mat-icon aria-label="Czas caÅ‚kowity">timer</mat-icon>
                    <span>{{ recipe().total_time_minutes | durationMinutes }}</span>
                </div>
            }
        </div>
    }

    <div class="recipe-meta">
        @if (recipe().is_termorobot) {
            <mat-chip class="termorobot-badge non-clickable">
                <mat-icon matChipAvatar>blender</mat-icon>
                Termorobot
            </mat-chip>
        }
        @if (getCategoryName(recipe())) {
            <!-- Prywatny kontekst: kategoria jako link -->
            @if (!isPublic()) {
                <a
                    class="category-link"
                    [routerLink]="['/recipes']"
                    [queryParams]="{ category: getCategoryId(recipe()) }"
                >
                    {{ getCategoryName(recipe()) }}
                </a>
            }
            <!-- Publiczny kontekst: kategoria jako badge (nieklikalne) -->
            @else {
                <span class="category-badge">
                    {{ getCategoryName(recipe()) }}
                </span>
            }
        }

        @if (recipe().tags && recipe().tags.length > 0) {
            <mat-chip-set class="tags-list" aria-label="Tagi przepisu">
                @for (tag of getTagsForDisplay(recipe()); track tag.id) {
                    <!-- Prywatny kontekst: tagi jako linki -->
                    @if (!isPublic()) {
                        <mat-chip
                            [routerLink]="['/recipes']"
                            [queryParams]="{ tag: tag.name }"
                        >
                            {{ tag.name }}
                        </mat-chip>
                    }
                    <!-- Publiczny kontekst: tagi jako chipy nieklikalne -->
                    @else {
                        <mat-chip class="non-clickable">
                            {{ tag.name }}
                        </mat-chip>
                    }
                }
            </mat-chip-set>
        }
    </div>
</header>
