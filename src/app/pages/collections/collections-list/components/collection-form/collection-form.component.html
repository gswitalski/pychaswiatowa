<h2 mat-dialog-title>{{ dialogTitle }}</h2>

<mat-dialog-content>
    <form [formGroup]="form" (ngSubmit)="onSubmit()" id="collection-form">
        <mat-form-field appearance="outline" class="full-width">
            <mat-label>Nazwa kolekcji</mat-label>
            <input
                matInput
                formControlName="name"
                placeholder="np. Ulubione śniadania"
                maxlength="100"
            />
            @if (form.controls.name.hasError('required')) {
                <mat-error>Nazwa jest wymagana</mat-error>
            }
            @if (form.controls.name.hasError('maxlength')) {
                <mat-error>Nazwa może mieć maksymalnie 100 znaków</mat-error>
            }
            <mat-hint align="end">{{ form.value.name?.length || 0 }}/100</mat-hint>
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width">
            <mat-label>Opis (opcjonalny)</mat-label>
            <textarea
                matInput
                formControlName="description"
                placeholder="Krótki opis kolekcji..."
                rows="3"
                maxlength="500"
            ></textarea>
            @if (form.controls.description.hasError('maxlength')) {
                <mat-error>Opis może mieć maksymalnie 500 znaków</mat-error>
            }
            <mat-hint align="end">{{ form.value.description?.length || 0 }}/500</mat-hint>
        </mat-form-field>

        @if (apiError()) {
            <div class="api-error">
                {{ apiError() }}
            </div>
        }
    </form>
</mat-dialog-content>

<mat-dialog-actions align="end">
    <button
        mat-button
        type="button"
        (click)="onCancel()"
        [disabled]="isSaving()"
    >
        Anuluj
    </button>
    <button
        mat-flat-button
        color="primary"
        type="submit"
        form="collection-form"
        [disabled]="isSaving()"
    >
        @if (isSaving()) {
            <mat-spinner diameter="20"></mat-spinner>
        } @else {
            {{ submitButtonText }}
        }
    </button>
</mat-dialog-actions>
